{% extends 'base.html.twig' %}

{% block title %}Ver Rutinas - Admin{% endblock %}
{% block stylesheets %}
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="{{ asset('css/style.css') }}">
{% endblock %}
{% block body %}
<div class="position-fixed top-0 start-0 m-3">
  <a href="{{ path('admin_panel') }}" class="btn btn-primary">Volver</a>
</div>

<header class="header text-center">
  <div class="header-content">
    <h1>Rutinas Guardadas</h1>
    <p>Visualiza y gestiona todas las rutinas creadas en Vida Saludable.</p>
  </div>
</header>

<div class="container py-5">
  <h2 class="mb-4 text-center"><img src="{{ asset('img/fuerza.png') }}" alt="Fuerza" style="height:40px;vertical-align:middle;margin-right:7px;">Rutinas Registradas</h2>
  <div class="text-end mb-4">
    <a href="{{ path('admin_crear_rutina') }}" class="btn btn-success">Crear nueva rutina</a>
  </div>
  {% for rutina in rutinas %}
    <div class="card mb-4 shadow-sm">
      <div class="card-body">
        <h5 class="card-title">{{ rutina.titulo|e }}</h5>
        <p class="mb-1"><strong>Objetivo:</strong> {{ rutina.objetivo }}</p>
        <p class="mb-1"><strong>Nivel:</strong> {{ rutina.nivel }}</p>
        <p class="mb-3"><strong>Duración:</strong> {{ rutina.duracion_total_min }} minutos</p>

        <h6 class="mb-2">Ejercicios incluidos:</h6>
        <ul class="list-group">
        {% for id in rutina.ejercicios %}
          {% set ej = ejerciciosMap[id ~ ''] ?? null %}
          {% if ej %}
            <li class="list-group-item">
              <strong>{{ ej.nombre|e }}</strong> – 
              {{ ej.repeticiones|e }} 
              ({{ ej.nivel }})
            </li>
          {% else %}
            <li class="list-group-item text-danger">Ejercicio no encontrado: {{ id }}</li>
          {% endif %}
        {% endfor %}
        </ul>
        <div class="d-flex justify-content-center gap-2 mt-4">
      <a href="{{ path('admin_editar_rutina', {'id': rutina._id}) }}" class="btn btn-warning btn-sm d-flex align-items-center px-3">
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-pencil me-1" viewBox="0 0 16 16">
          <path d="M12.146.854a.5.5 0 0 1 .708 0l2.292 2.292a.5.5 0 0 1 0 .708l-10 10a.5.5 0 0 1-.168.11l-4 1.5a.5.5 0 0 1-.65-.65l1.5-4a.5.5 0 0 1 .11-.168l10-10zm.708-.708a1.5 1.5 0 0 0-2.121 0l-10 10a1.5 1.5 0 0 0-.328.497l-1.5 4A1.5 1.5 0 0 0 2.5 16a1.5 1.5 0 0 0 .497-.328l4-1.5a1.5 1.5 0 0 0 .497-.328l10-10a1.5 1.5 0 0 0 0-2.121l-2.292-2.292z"/>
        </svg>
        Editar
      </a>
      <form method="post" action="{{ path('admin_eliminar_rutina', {'id': rutina._id}) }}" onsubmit="return confirm('¿Seguro que quieres eliminar esta rutina?');">
        <button type="submit" class="btn btn-danger btn-sm d-flex align-items-center px-3">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-trash me-1" viewBox="0 0 16 16">
            <path d="M5.5 5.5A.5.5 0 0 1 6 5h4a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-.5.5H6a.5.5 0 0 1-.5-.5v-7zm1 .5v6h2v-6h-2z"/>
            <path fill-rule="evenodd" d="M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1 0-2h3.5a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1H14a1 1 0 0 1 1 1zm-11 1v9a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4h-8z"/>
          </svg>
          Eliminar
        </button>
      </form>
    </div>
      </div>
    </div>
  {% endfor %}
</div>
{% endblock %}